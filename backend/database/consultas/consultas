--1
SELECT s.nombre_servicio, s.descripcion, s.precio_base, u.nombre_completo AS proveedor
FROM servicios s
JOIN usuario u ON s.proveedor_id = u.id;
--2
SELECT hs.historial_id, s.nombre_servicio, hs.fecha_arrendamiento, hs.duracion, hs.estado
FROM historial_servicios hs
JOIN servicios s ON hs.servicio_id = s.id
WHERE hs.arrendador_id = (SELECT id FROM usuario WHERE nombre_completo = 'María Gómez');
--3
SELECT c.nombre_categoria, s.nombre_servicio, s.precio_base
FROM servicios s
JOIN categoria c ON s.categoria_id = c.categoria_id
ORDER BY c.nombre_categoria;
--4
SELECT u.nombre_completo AS proveedor, COUNT(s.id) AS total_servicios
FROM usuario u
LEFT JOIN servicios s ON u.id = s.proveedor_id
GROUP BY u.id;
--5
SELECT s.nombre_servicio, hs.fecha_arrendamiento, u.nombre_completo AS arrendador
FROM historial_servicios hs
JOIN servicios s ON hs.servicio_id = s.id
JOIN usuario u ON hs.arrendador_id = u.id
WHERE hs.estado = 'activo';
--6
SELECT u.nombre_completo AS arrendador, s.nombre_servicio, hs.fecha_arrendamiento
FROM usuario u
JOIN historial_servicios hs ON u.id = hs.arrendador_id
JOIN servicios s ON hs.servicio_id = s.id
ORDER BY u.nombre_completo;
--7
SELECT hs.estado, COUNT(hs.historial_id) AS total
FROM historial_servicios hs
GROUP BY hs.estado;
